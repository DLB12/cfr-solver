This project uses CFR to discover the optimal strategies (represented as probability distributions of frequencies of folding, checking/calling, betting/raising to avoid exploitability) at various decision points for 100 fixed boards given an information set containing imperfect information a poker player would know (ie. their own cards, the board, betting history, etc).

The 52 cards in the deck are initially represented as integers from 1 to 52. However, in the hand evaluation process, these integers are shifted down by 1 and rearranged systematically in terms of the card they represent.

Every information set at a given game state where a decision must be made by the player is representable as a string. The string (information set key) contains the player's hand, board, then betting history. In particular, the player's hand is represented as the corresponding two integers in increasing order, and the board is also represented by the integers corresponding to the cards in increasing order. Since players are restricted to only one betting/raising amount and there is a limit to the number of raises on a street, it is unambiguous and feasible to represent the entire betting history as a sequence of letters "r", "k", "c", "f" representing "raise", "check", "call", and "fold" respectively (with separation between actions taken at different streets). Note that this representation is meant for ease of interpretation, and in actual implementation the information set is hashed through the Polynomial Rolling Hash to increase efficiency. One prime is used to hash the player hand and board, while a different prime is used to hash the betting history. Note that the betting history is partitioned character by character, and each character is converted to its ASCII integer value.

To train a machine learning model that identifies the optimal strategy in an arbitrary board, we use the information sets and Nash Equilibrium strategies at different decision points of the 100 fixed boards as training data and the labels (we can reserve a portion for testing). Instead of using the raw representations or hashed representations of the information sets, we can use lists of one-hot vectors or multi-hot vectors to represent the player hand and board. The betting history can be summarized into a few crucial features (ie. total number of raises) concatenated into a vector, or the raw representation of the betting history can directly be converted into a vector. Together, these representations of the player hand, board, and betting history constitute the features the model trains on. 